<body onload='function f(){r=1,B=[[1,7],[2,7],[3,7],[4,7]],e=4,F=[],N=[],v=2,P=0,S=300,t=setInterval(h,S)}function h(){if(!d++){if(H=B[e-1],n=[H[0]+(2==v?1:v?0:-1),H[1]+(3==v?1:1==v?-1:0)],n[0]<0|n[0]==a|n[1]<0|n[1]==b||j(n,B)){clearInterval(t);d=r=0;alert(":(");return}for(B.push(n),e++,(g=j(n,F))?(P++,S-=8,F.splice(g-1,1)):(g=j(n,N))?(S+=30,N.splice(g-1,1),e>20&&(e-=e>>2,B=B.slice(-e))):(B.shift(),e--),g&&(clearInterval(t),t=setInterval(h,S)),F.length&&5!=l(12)||k(F),e>18&5==l(25+N.length)&&k(N),c="",y=0;b>y;y++){for(x=0;a>x;x++)p=[x,y],c+=j(p,B)?"O":j(p,F)?"F":j(p,N)?"p":"\xB7";c+="\n"}c+=P+"\n"+e+" g\n"+(1e3-S)+" cm/min",E.innerHTML=c,d=0}}function j(a,b){for(i=b.length;i--&&""+a!=""+b[i];);return i+1}function k(c){for(o=l(b*a-1-e-F.length-N.length),s=0,x=a;x--;)for(y=b;y--;j(p,B.concat(F,N))||(s==o&&c.push(p),s++))p=[x,y]}function l(a){return Math.random()*++a|0}var a=30,b=15,e=v=g=B=t=S=P=F=N=d=r=0;onkeyup=function(a){r||f(),w=a.which%37%4,(v+2)%4^w?v=w:0}'><pre id=E>Use the arrow keys